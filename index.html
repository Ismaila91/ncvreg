<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Regularization Paths for SCAD and MCP Penalized Regression Models • ncvreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<script src="extra.js"></script><meta property="og:title" content="Regularization Paths for SCAD and MCP Penalized Regression Models">
<meta property="og:description" content='Fits regularization paths for linear regression, GLM, and Cox
  regression models using lasso or nonconvex penalties, in particular the
  minimax concave penalty (MCP) and smoothly clipped absolute deviation (SCAD)
  penalty, with options for additional L2 penalties (the "elastic net" idea).
  Utilities for carrying out cross-validation as well as post-fitting
  visualization, summarization, inference, and prediction are also provided.'>
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ncvreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Learn more
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/web/models.html">Models</a>
    </li>
    <li>
      <a href="articles/web/penalties.html">Penalties</a>
    </li>
    <li>
      <a href="articles/web/inference-mfdr.html">Inference: Marginal false discovery rates</a>
    </li>
    <li>
      <a href="articles/web/inference-local.html">Inference: Local mfdr</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pbreheny/ncvreg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="regularization-paths-for-scad-and-mcp-penalized-regression-models" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#regularization-paths-for-scad-and-mcp-penalized-regression-models" class="anchor"></a>Regularization Paths for SCAD and MCP Penalized Regression Models</h1></div>
<p><code>ncvreg</code> is an R package for fitting regularization paths for linear regression, GLM, and Cox regression models using lasso or nonconvex penalties, in particular the minimax concave penalty (MCP) and smoothly clipped absolute deviation (SCAD) penalty, with options for additional L<sub>2</sub> penalties (the “elastic net” idea). Utilities for carrying out cross-validation as well as post-fitting visualization, summarization, inference, and prediction are also provided.</p>
<p>This site focuses mainly on illustrating the usage and syntax of <code>ncvreg</code>. For more on the algorithms used by <code>ncvreg</code>, see the original article:</p>
<ul>
<li><a href="http://myweb.uiowa.edu/pbreheny/pdf/Breheny2011.pdf">Breheny P and Huang J (2011). Coordinate descent algorithms for nonconvex penalized regression, with applications to biological feature selection. <em>Annals of Applied Statistics</em>, 5: 232–253</a></li>
</ul>
<p>For more about the marginal false discovery rate idea used for post-selection inference, see</p>
<ul>
<li><a href="https://arxiv.org/pdf/1607.05636">Breheny P (to appear). Marginal false discovery rates for penalized regression models. <em>Biostatistics</em></a></li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><code>ncvreg</code> is on CRAN, so it can be installed via:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"ncvreg"</span>)</a></code></pre></div>
</div>
<div id="brief-introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#brief-introduction" class="anchor"></a>Brief introduction</h2>
<p>Given a design matrix <code>X</code> and response vector <code>y</code>, we can fit a penalized regression model via:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="reference/ncvreg.html">ncvreg</a></span>(X, y)</a></code></pre></div>
<p>By default, <code>ncvreg</code> fits a linear regression model with a minimax concave penalty (MCP). For more detail on other types of models available, see <a href="articles/web/models.html">here</a>. For more detail on other types of penalties available, see <a href="articles/web/penalties.html">here</a>.</p>
<p>Fitting a penalized regression model produces a path of coefficients, which we can plot with</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(fit)</a></code></pre></div>
<p><img src="index_files/figure-html/plot-1.png" width="480"></p>
<p>Notice that variables enter the model one at a time, and that at any given value of <span class="math inline">\(\lambda\)</span>, several coefficients are zero. To see what the coefficients are, we could use the <code>coef</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(fit, <span class="dt">lambda=</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># (Intercept)      lcavol     lweight         age        lbph         svi </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#  0.35121089  0.53178994  0.60389694 -0.01530917  0.08874563  0.67256096 </span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#         lcp     gleason       pgg45 </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#  0.00000000  0.00000000  0.00168038</span></a></code></pre></div>
<p>The <code>summary</code> method can be used for post-selection inference:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(fit, <span class="dt">lambda=</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co"># MCP-penalized linear regression with n=97, p=8</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co"># At lambda=0.0500:</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co"># -------------------------------------------------</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#   Nonzero coefficients         : 6</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#   Expected nonzero coefficients: 2.51</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#   Average mfdr (6 features)    : 0.418</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co"># </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#         Estimate      z      mfdr</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co"># lcavol   0.53179  8.880   &lt; 1e-04</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co"># svi      0.67256  3.945 0.0018967</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co"># lweight  0.60390  3.666 0.0050683</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co"># lbph     0.08875  1.928 0.4998035</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co"># age     -0.01531 -1.788 1.0000000</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co"># pgg45    0.00168  1.160 1.0000000</span></a></code></pre></div>
<p>In this case, it would appear that <code>lcavol</code>, <code>svi</code>, and <code>lweight</code> are clearly associated with the response, even after adjusting for the other variables in the model, while <code>lbph</code>, <code>age</code>, and <code>pgg45</code> may be false positives selected simply by chance.</p>
<p>Typically, one would carry out cross-validation for the purposes of assessing the predictive accuracy of the model at various values of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">cvfit &lt;-<span class="st"> </span><span class="kw"><a href="reference/cv-ncvreg.html">cv.ncvreg</a></span>(X, y)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(cvfit)</a></code></pre></div>
<p><img src="index_files/figure-html/cvplot-1.png" width="480"></p>
<p>The value of <span class="math inline">\(\lambda\)</span> that minimizes the cross-validation error is given by <code>cvfit$lambda.min</code>, which in this case is 0.028. Applying <code>coef</code> to the output of <code>cv.ncvreg</code> returns the coefficients at that value of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(cvfit)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#  (Intercept)       lcavol      lweight          age         lbph </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#  0.494151714  0.569546490  0.614419845 -0.020913442  0.097352556 </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#          svi          lcp      gleason        pgg45 </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#  0.752400486 -0.104960299  0.000000000  0.005324462</span></a></code></pre></div>
<p>Predicted values can be obtained via <code>predict</code>, which has a number of options:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(cvfit, <span class="dt">X=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(X))     <span class="co"># Prediction of response for new observations</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#         1         2         3         4         5         6 </span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co"># 0.8304032 0.7650898 0.4262070 0.6230109 1.7449493 0.8449584</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(cvfit, <span class="dt">type=</span><span class="st">"nvars"</span>)  <span class="co"># Number of nonzero coefficients</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co"># 0.02762 </span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#       7</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(cvfit, <span class="dt">type=</span><span class="st">"vars"</span>)   <span class="co"># Identity of the nonzero coefficients</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#  lcavol lweight     age    lbph     svi     lcp   pgg45 </span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#       1       2       3       4       5       6       8</span></a></code></pre></div>
<p>Note that the original fit (to the full data set) is returned as <code>cvfit$fit</code>; it is not necessary to call both <code>ncvreg</code> and <code>cv.ncvreg</code> to analyze a data set. For example, <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot(cvfit$fit)</a></code> will produce the same coefficient path plot as <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot(fit)</a></code> above.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=ncvreg">https://​cloud.r-project.org/​package=ncvreg</a>
</li>
<li>Browse source code at <br><a href="https://github.com/pbreheny/ncvreg">https://​github.com/​pbreheny/​ncvreg</a>
</li>
<li>Report a bug at <br><a href="http://github.com/pbreheny/ncvreg/issues">http://​github.com/​pbreheny/​ncvreg/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing ncvreg</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Patrick Breheny <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/000-0002-0650-1119" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
